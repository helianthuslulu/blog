<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   
   <title>cookies and 缓存</title>
   
   <meta name="author" content="xiyoulaoyuanjia" />
   <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
   <!--   <link href="http://feeds.julianyap.com/julianyap" rel="alternate" title="Julian Yap" type="application/rss+xml" /> -->
   <link href="https://plus.google.com/111539417571342089192" rel="publisher" />
   <link rel="shortcut icon" href="/favicon.ico" />

   <!-- syntax highlighting CSS -->
   <!--   <link rel="stylesheet" href="/css/syntax.css" type="text/css" /> -->

   <!-- Homepage CSS -->
   <!--
   <link rel="stylesheet" type="text/css" href="/css/base.css">
   <link rel="stylesheet" type="text/css" href="/css/skeleton.css">
   <link rel="stylesheet" type="text/css" href="/css/layout.css">
   -->
   <!--这里去掉 site.baseurl 的原因是当 github page 是 gh-pages 时这里会体现差异 -->
   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/css/syntax.css" type="text/css" />  
   <!-- Homepage CSS -->
   <link rel="stylesheet" type="text/css" href="/css/base.css">
   <link rel="stylesheet" type="text/css" href="/css/skeleton.css">
   <link rel="stylesheet" type="text/css" href="/css/layout.css">


</head>
<body>

<div class="container">
  <div class="sixteen columns title">
    <a href="/" title="xiyoulaoyuanjia: Home">xiyoulaoyuanjia</a>
  </div>
  
  <div class="eleven columns">
  
<h1>cookies and 缓存</h1>

<div id="post">
<p><strong>cookie 的分类</strong></p>

<blockquote><ul>
<li>会话cookies</li>
</ul>
</blockquote>

<p>是一种临时cookies。记录用户登录网站的设置与偏好信息。。关闭浏览器就清除了</p>

<blockquote><ul>
<li>持久cookies</li>
</ul>
</blockquote>

<p>持久icookies 存在硬盘中。。有过期时间</p>

<p><strong>为什么需要cookies</strong></p>

<p>这是因为http协议是无状态的。。对于一个浏览器发出的多次请求，WEB服务器无法区分 是不是来源于同一个浏览器
所以浏览器需要额外的信息维持会话。。</p>

<p><strong>cookies 的限制</strong>
一些浏览器支持最大 4096字节的cookies。另一些支持最多20个cookies 超过的旧的就会陪删除</p>

<p><strong>cookie 存放</strong></p>

<blockquote><ul>
<li>不同的浏览器会存放在不同的地方</li>
<li>不同的网站会有不同的cookie文件</li>
</ul>
</blockquote>

<p>windows 下的ie 是 存放在临时文件夹下面的
<img src="http://openapi.vdisk.me/?m=file&amp;a=download_share_file&amp;ss=b8d8XgiPVdBwl--2FE1cDVwvaVmWbbRE4XCNtT--2FlY1xJjdPDtpaWU6suLNJo37weV1zBE7cBBfg8R--2BmMF3BS67BH0ciHlhz" alt="" /></p>

<p>linux 下的 chrome 是存放在 sqllite3 数据库中的
<img src="http://openapi.vdisk.me/?m=file&amp;a=download_share_file&amp;ss=6c17G8HyRRw8uUSDMtgmnCv6jYSnXXMsZICNspz5lUjWr735mfcbR4qBay5Sv9c6BiUoE8L4PYSiY8BSE8OyCQd--2BDKBb" alt="" /></p>

<p><strong>cookies 在 http中的使用</strong></p>

<p>浏览器把 cookies 在 http 的 Request 中 Cookie: header 发送</p>

<p>Web服务器通过HTTP Response中的"Set-Cookie: header"把cookie发送给浏览器</p>

<p><strong>cookies 与文件缓存的区别</strong></p>

<p>这两个是不一样的东西。。。在ie中可能存放在同一个文件夹下。。但一般在设置浏览器时
都可以选择分别设置cookies 与 缓存的</p>

<p><strong>http协议之缓存</strong></p>

<blockquote><ul>
<li>http 中具有浏览器缓存。缓存代理服务器</li>
<li>http 缓存是指当web 请求到达缓存时可以考虑从本地提取缓存而不用在次从服务器发请求</li>
<li><p>缓存的好处</p>

<blockquote><ul>
<li>减少了服务器的压力</li>
<li>加快了浏览器的加载速度</li>
</ul>
</blockquote></li>
<li><p>与缓存有关的header</p>

<blockquote><ul>
<li>Request</li>
</ul>
</blockquote></li>
</ul>
</blockquote>

<pre><code>Cache-Control: max-age=0    以秒为单位
If-Modified-Since: Mon, 19 Nov 2012 08:38:01 GMT  缓存文件的最后修改时间。
If-None-Match: "0693f67a67cc1:0"    缓存文件的Etag值
Cache-Control: no-cache            不使用缓存
Pragma: no-cache               不使用缓存
</code></pre>

<blockquote><blockquote><ul>
<li>Response</li>
</ul>
</blockquote></blockquote>

<pre><code>Cache-Control: public    响应被缓存，并且在多用户间共享，  （公有缓存和私有缓存的区别，请看另一节）
Cache-Control: private  响应只能作为私有缓存，不能在用户之间共享
Cache-Control:no-cache  提醒浏览器要从服务器提取文档进行验证
Cache-Control:no-store  绝对禁止缓存（用于机密，敏感文件）
Cache-Control: max-age=60   60秒之后缓存过期（相对时间）
Date: Mon, 19 Nov 2012 08:39:00 GMT 当前response发送的时间
Expires: Mon, 19 Nov 2012 08:40:01 GMT  缓存过期的时间（绝对时间）
Last-Modified: Mon, 19 Nov 2012 08:38:01 GMT    服务器端文件的最后修改时间
ETag: "20b1add7ec1cd1:0"    服务器端文件的Etag值
</code></pre>

<blockquote><ul>
<li>如何判断缓存的新鲜度
这里的新鲜度指文件是否修改。提出了两种方法</li>
</ul>


<blockquote><ul>
<li>文件的最后修改时间  在head 中通过  "If-Modified-Since" 字段标识</li>
</ul>


<blockquote><ul>
<li>服务器发送状态吗 304 来标识没有修改</li>
<li>如图</li>
</ul>
</blockquote></blockquote></blockquote>

<p>文件没有修改
<img src="http://openapi.vdisk.me/?m=file&amp;a=download_share_file&amp;ss=bf087nR3bMs2UgOEyuNZuISV4xmw--2FkKe--2FmShGj5LGoXwDVPJq9A03u1fRJ6tni1T44fP3fvUkSUZBbP1Wr4v8EnN--2F8TH" alt="" /></p>

<p>文件已经修改
<img src="http://openapi.vdisk.me/?m=file&amp;a=download_share_file&amp;ss=dff4kSeiBh2mSmlqcoMfJaPVtIydvVU8QQKxTys3yv1v0Px--2BS0DzkwiN1z3Ie--2BDG0ogkpYiskEKNkbNWYQ9MvyBPompQ" alt="" /></p>

<blockquote><blockquote><ul>
<li>文件的hash 签名 Etag 在head 中通过  "If-None-Match" 字段来标识  Etag 是可以看成是对 最后修改时间的一种补充

<blockquote><ul>
<li>有些服务器没有办法获得文件的最后修改时间</li>
<li>If-Modified-Since 是精确到秒的 对于 秒以下的文件修改则没有办法</li>
<li>一些文件最后修改时间变了。内容却没有改变</li>
</ul>
</blockquote></li>
</ul>
</blockquote>

<ul>
<li>直接使用缓存不去服务器验证
这里 说一个例子
按F5刷新浏览器和在地址栏里输入网址然后回车。 这两个行为是不一样的。</li>
</ul>


<blockquote><ul>
<li>在浏览器里输入网址 然后按回车 会直接使用缓存 不去服务器验证的。。。</li>
<li>F5刷新 需要验证</li>
</ul>
</blockquote></blockquote>

</div>

<div>
<a href="https://twitter.com/share" class="twitter-share-button" data-via="jyap" data-size="large">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</div>

<div align="right" class="date-container">16 APRIL 2013 @ 04:29AM</div>

<div id="related">
  <h1>Related Posts</h1>
  <ul class="posts">
    
      <li><span class="post_date">21 Apr 2013</span> &raquo; <a href="/2013/04/21/%E4%BD%BF%E7%94%A8ajax%E4%B8%8A%E4%BC%A0%E6%96%87%E6%A1%A3.html">使用ajax上传文档</a></li>
    
      <li><span class="post_date">16 Apr 2013</span> &raquo; <a href="/2013/04/16/python-%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98.html">python 编码问题</a></li>
    
      <li><span class="post_date">16 Apr 2013</span> &raquo; <a href="/2013/04/16/python-%E4%B8%AD-sqlite3-%E7%9A%84%E4%BD%BF%E7%94%A8.html">python 中 sqlite3 的使用</a></li>
    
  </ul>
</div>


  </div>
  <div class="four columns offset-by-one">
  <h1>Pages</h1>
  <ul class="posts">
    <li><a href="/pages/about.html">About</a></li>
    <li><a href="/pages/archives.html">Archives</a></li>
    <li><a href="/pages/projects.html">Projects</a></li>
  </ul>
  <!-- AddThis Button BEGIN -->
  <h1>Follow Me</h1>
  <div class="addthis_toolbox addthis_32x32_style addthis_vertical_style">
  <a class="addthis_button_twitter_follow" addthis:userid="jyap"></a>
  <a class="addthis_button_google_follow" addthis:userid="111539417571342089192"></a>
  <a class="addthis_button_rss_follow" addthis:url="http://feeds.julianyap.com/julianyap"></a>
  </div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid=xa-4f30f5735bbf9458"></script>
  <!-- AddThis Button END -->
  </div>

  <div class="sixteen columns footer">
    <div class="contact">
      <p>
        Copyright © xiyoulaoyuanjia now
      </p>
    </div>
    <div>
      <p>
      Follow Julian: <a href="http://twitter.com/jyap">Twitter</a> / <a href="https://plus.google.com/111539417571342089192/" rel="author">Google+</a> / <a href="http://feeds.julianyap.com/julianyap">RSS</a>
      </p>
    </div>
  </div>
</div>
<!-- Analytics -->
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://www2.julianyap.com/stats/" : "http://www2.julianyap.com/stats/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="http://www2.julianyap.com/stats/piwik.php?idsite=1" style="border:0" alt="" /></p></noscript>


</body>
</html>
